# PokedexApi
A Pokedex built in .NET 5 Web API framework that retrieves a Pokemon's basic information using public APIs.
## How to Run
I personally used Visual Studio to develop, test and run the project, but there are multiple ways to run this project. The different methods are listed below.

**First, clone the repo in to the desired folder using CLI `git clone https://github.com/sanjayh94/PokedexApi/` or your favourite IDE/GUI tool.**

*You will need git CLI installed for this command to work, Find instructions [here](https://git-scm.com/book/en/v2/Getting-Started-Installing-Git)*
### Docker
1. Install Docker if you haven't already. Find instructions [here](https://docs.docker.com/get-docker/). _Note: Verify Docker is running on Linux containers mode._
2. Open your preferred terminal and Navigate to the directory where you cloned the repo earlier. For example `cd ~/repos/PokedexApi`
3. Build Image `docker build -f PokedexApi/Dockerfile -t pokedexapi .`
4. Run Image `docker run --rm -p 5000:80 pokedexapi`. 

**Note: the first port denoted after the `-p` parameter is the host port where the application is exposed i.e. port 5000 in this case. Your endpoint port will change depending on the port you specified here.** For example `http://localhost:5000/pokemon/{pokemonName}`. Ignore the `Now listening on: http://[::]:80` in the logs.

### Visual Studio (or VSCode)
1. Install Visual Studio (or VSCode if preferred) from [here](https://visualstudio.microsoft.com/downloads/).
2. Navigate to the directory where you cloned the repo earlier and open the Solution from the `PokedexApi.sln` file in the root of the directory.
3. Hit the Run icon and the project should build and launch in a browser.
4. Take a note of the url and port when the browser launches to test the endpoint. For example, `http://localhost:5000/`

_Note: You will have to Install the C# extension and/or the .NET SDK, if you are planning to use VSCode. It should automatically prompt you to install when you open the project for the first time._

### dotnet CLI
1. Install .NET SDK (CLI tools are bundled) if you haven't already. Find instructions [here](https://dotnet.microsoft.com/download). If you installed Visual Studio in the previous step, .NET CLI should already be installed.
2. Open your preferred terminal and Navigate to the directory where you cloned the repo earlier. For example `cd ~/repos/PokedexApi`
3. Build the project using `dotnet build` command. Make sure the Build succeeds at this stage
4. Run the 'PokedexApi' project using `dotnet run --project PokedexApi`. Make note of the url and port from the log `Now listening on: http://localhost:5000`

## Testing endpoints
Run the project using any of the methods above, and then use your preferred API client (Postman, httpie, curl or even your browser!) to test these endpoints. Make sure the the correct port is used when querying the endpoints. Replace the port `5000` with your own.

+ GET `http://localhost:5000/swagger` : Autogenerated OpenAPI swagger documentation. You can also use this to try the endpoints out. Click the appropriate endpoint and click the `Try it out` button. Input a Pokemon Name in the parameters box and click the `Execute` button to initiate an API call.
+ GET `http://localhost:5000/pokemon/{pokemonName}` : Given a Pokemon name, returns standard Pokemon description and additional information
  + Example call using httpie `http localhost:5000/pokemon/onix`
  + Response would be 
  ```json
  {
    "description": "As it grows, the stone portions of its body harden to become similar to a diamond, but colored black.",
    "habitat": "cave",
    "isLegendary": false,
    "name": "onix"
  }
  ```
  
+ GET `http://localhost:5000/pokemon/translated/{pokemonName}` : Given a Pokemon name, return translated Pokemon description and other basic infomation. Conditions apply such that, If the Pokemon's habitat is `cave` or it's a legendary Pokemon then Yoda translation will be applied. The rest of the Pokemons will have the Shakespeare translation. The standard description is returned on fallback (such as if the translation API is rate-limited)
  + Example call using httpie `http localhost:5000/pokemon/translated/onix`
  + Response would be 
  ```json
  {
    "description": "As it grows,To become similar to a diamond,  the stone portions of its body harden,But colored black.",
    "habitat": "cave",
    "isLegendary": false,
    "name": "onix"
  }
  ``` 
  + _Note: Be mindful of making multiple requests to this endpoint as the public translation API is rate-limited to 5 calls per hour. However the app is configured to return a standard description if that happens._

## Running Tests
![Running Tests in Visual Studio](https://user-images.githubusercontent.com/94787187/143479724-69f4d5f5-9902-4aa0-8d5e-7f8b3ecd7aa9.png)

The project consists of a number of Unit Tests and Smoke Tests. Unit tests test methods in isolation of dependencies and Smoke Tests are end-to-end tests that involve making API calls to the project and the third party APIs as well. Smoke tests are useful for a final sanity check before deploying to Production.

Note: Smoke tests make actual API calls. The `/pokemon/translated` is rate-limited by the external API to 5 calls per hour, so there are chances it may fail. Therefore these tests are skipped. To un-skip them, the `[Fact(Skip)]` attribute code can be replaced with `[Fact]`.

```C#
// File: /PokemonApi.Tests/PokemonSmokeTests.cs

 [Fact(Skip = "Skipping Translated Endpoint as Public Endpoint is ratelimited to 5 calls per hour")]
  //[Fact]
  public async Task Get_PokemonTranslated_Cave_ReturnsExpectedJsonContent_YodaTranslation()
  {
      // Arrange
      string pokemonName = "onix";
      string url = $"/pokemon/translated/{pokemonName}";
      
  // rest of the code ommitted
```

### Using Visual Studio (or VSCode)
### Using dotnet CLI
## Design Decisions and Code Structure
## Approach for Production
